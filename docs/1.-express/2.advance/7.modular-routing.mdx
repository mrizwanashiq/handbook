---
sidebar_position: 1
id: modular-routing
title: Modular Routing
# description: 
slug: modular-routing
---

Imagine this scenario: There are students, enrolled in a class, and many teachers teach that class. If you use the basic routing methods defined above, the code (`index.js`) will look like this:

```js
import express from 'express';
import bodyParser from 'body-parser';
import cors from 'cors';

const app = express();

// We will keep data here
let students = [];
let teachers = [];
let courses = [];

// Configuring middlewares
app.use(cors());
app.use(bodyParser.urlencoded({ extended: false }));
app.use(bodyParser.json());

// CRUD operations for students

app.get('/students', (req, res) => {
    res.send(students);
})

app.post('/students', (req, res) => {
    students.push(req.body);
    res.send(students);
})

app.put('/students/:id', (req, res) => {
    const id = req.params.id;
    const student = students.find(student => student.id === id);
    student.name = req.body.name;
    res.send(student);
})

app.delete('/students/:id', (req, res) => {
    const id = req.params.id;
    students = students.filter(student => student.id !== id);
    res.send(students);
})

// CRUD operations for teachers

app.get('/teachers', (req, res) => {
    res.send(teachers);
})

app.post('/teachers', (req, res) => {
    teachers.push(req.body);
    res.send(teachers);
})

app.put('/teachers/:id', (req, res) => {
    const id = req.params.id;
    const teacher = teachers.find(teacher => teacher.id === id);
    teacher.name = req.body.name;
    res.send(teacher);
})

app.delete('/teachers/:id', (req, res) => {
    const id = req.params.id;
    teachers = teachers.filter(teacher => teacher.id !== id);
    res.send(teachers);
})

// CRUD operations for courses

app.get('/courses', (req, res) => {
    res.send(courses);
})

app.post('/courses', (req, res) => {
    courses.push(req.body);
    res.send(courses);
})

app.put('/courses/:id', (req, res) => {
    const id = req.params.id;
    const course = courses.find(course => course.id === id);
    course.name = req.body.name;
    res.send(course);
})

app.delete('/courses/:id', (req, res) => {
    const id = req.params.id;
    courses = courses.filter(course => course.id !== id);
    res.send(courses);
})

app.listen(3000);
```

Notice that our code is a bit messy. However, writing the routes over and over increases redundancy and typos. Furthermore, it is helpful to make our code more modular, as it is good practice.

As a programmer, you always want to make your code look cleaner. To make the above code easier to read, There are several ways to create routes. For this blog, I'm, going to use the [express.Router](https://expressjs.com/en/guide/routing.html#express-router) middleware as it allows us to group the route handlers for a particular part of a site together and access them using a common route-prefix. We'll keep all our library-related routes in a "catalog" module, and, if we add routes for handling user accounts or other functions, we can keep them grouped separately.

## express.Router()
### Introduction:
We can use `express.Router()` to create modular, mountable route handlers. A Router instance is a complete middleware and routing system, which is why it is often referred to as a "mini-app".

We only need to specify the starting point, and the Router instance will handle the rest for us.

The code first imports the Express application object, uses it to get a Router object, and then adds a couple of routes to it using the get() method. Last of all the module exports the Router object.

### Example:
```js
import express from 'express';
const router = express.Router();

// Home page route.
router.get('/', function (req, res) {
    res.send('Wiki home page');
})

// About page route.
router.get('/about', function (req, res) {
    res.send('About this wiki');
})

export default router;
```
### Our file structure will be like:

|_ modularRouting

    |_ index.js

    |_ node_modules
    
    |_ routes

        |_ students.js

        |_ teachers.js

        |_ courses.js

    |_ package-lock.json

    |_ package.json

### `package.json`:
```json
{
    "name": "modular-routing",
    "version": "1.0.0",
    "description": "",
    "main": "index.js",
    "type": "module",
    "scripts": {
    "start": "node index.js",
    "dev": "nodemon index.js"
    },
    "author": "mrizwanashiq",
    "license": "ISC",
    "dependencies": {
    "body-parser": "^1.20.0",
    "cors": "^2.8.5",
    "express": "^4.17.2",
    "nodemon": "^2.0.15"
    }
}
```
> MOST IMPORTANT: Project will start from `index.js`, not any individual routes 

### `index.js`:
```js
import express from 'express';
import bodyParser from 'body-parser';
import cors from 'cors';
import students from './routes/students.js';
import teachers from './routes/teachers.js';
import courses from './routes/courses.js';

const app = express()

// Configuring middlewares
app.use(cors());
app.use(bodyParser.urlencoded({ extended: false }));
app.use(bodyParser.json());

app.use('/students', students); 
// '/students' is the prefix for the students routes

app.use('/teachers', teachers); 
// '/teachers' is the prefix for the teachers routes

app.use('/courses', courses);   
// '/courses' is the prefix for the courses routes

app.listen(3000);
```

### `routes/students.js`:
```js
import express from 'express';
const router = express.Router()

let students = []

router.get('/', (req, res) => {
    res.send(students)
})

router.post('/', (req, res) => {
    students.push(req.body)
    res.send(students)
})

router.put('/:id', (req, res) => {
    const id = req.params.id
    const student = students.find(student => student.id == id)
    student.name = req.body.name
    res.send(students)
})

router.delete('/:id', (req, res) => {
    const id = req.params.id
    students = students.filter(student => student.id != id)
    res.send(students)
})

export default router;
```

### `routes/teachers.js`:
```js

import express from 'express';
const router = express.Router()

let teachers = []

router.get('/', (req, res) => {
    res.send(teachers)
})

router.post('/', (req, res) => {
    teachers.push(req.body)
    res.send(teachers)
})

router.put('/:id', (req, res) => {
    const id = req.params.id
    const student = teachers.find(student => student.id == id)
    student.name = req.body.name
    res.send(teachers)
})

router.delete('/:id', (req, res) => {
    const id = req.params.id
    teachers = teachers.filter(student => student.id != id)
    res.send(teachers)
})

export default router;
```

### `routes/courses.js`:
```js
import express from 'express';
const router = express.Router()

let courses = []

router.get('/', (req, res) => {
    res.send(courses)
})

router.post('/', (req, res) => {
    courses.push(req.body)
    res.send(courses)
})

router.put('/:id', (req, res) => {
    const id = req.params.id
    const student = courses.find(student => student.id == id)
    student.name = req.body.name
    res.send(courses)
})

router.delete('/:id', (req, res) => {
    const id = req.params.id
    courses = courses.filter(student => student.id != id)
    res.send(courses)
})

export default router;
```


Like always, you can use different routes in the routes' module, but the only thing you need to specify is the starting point in `app.use` in `index.js`.

## Code

You can download the related code from [here](https://github.com/mrizwanashiq/learning-express-js/tree/example/modular-routing-code)
