"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[5637],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>h});var o=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=o.createContext({}),p=function(e){var t=o.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},d=function(e){var t=p(e.components);return o.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},c=o.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,l=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),c=p(n),h=a,k=c["".concat(l,".").concat(h)]||c[h]||u[h]||r;return n?o.createElement(k,i(i({ref:t},d),{},{components:n})):o.createElement(k,i({ref:t},d))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,i=new Array(r);i[0]=c;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:a,i[1]=s;for(var p=2;p<r;p++)i[p]=n[p];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}c.displayName="MDXCreateElement"},8972:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>u,frontMatter:()=>r,metadata:()=>s,toc:()=>p});var o=n(7462),a=(n(7294),n(3905));const r={sidebar_position:6,id:"crud",title:"CRUD in Express",slug:"crud"},i=void 0,s={unversionedId:"express/basics/crud",id:"express/basics/crud",title:"CRUD in Express",description:"What is CRUD?",source:"@site/docs/1.-express/1.basics/6.CRUD.mdx",sourceDirName:"1.-express/1.basics",slug:"/express/basics/crud",permalink:"/docs/express/basics/crud",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/1.-express/1.basics/6.CRUD.mdx",tags:[],version:"current",sidebarPosition:6,frontMatter:{sidebar_position:6,id:"crud",title:"CRUD in Express",slug:"crud"},sidebar:"tutorialSidebar",previous:{title:"What is REST API and Why we use it",permalink:"/docs/express/basics/rest-api"},next:{title:"Advance",permalink:"/docs/category/advance"}},l={},p=[{value:"What is CRUD?",id:"what-is-crud",level:2},{value:"What we&#39;re building",id:"what-were-building",level:2},{value:"Getting started",id:"getting-started",level:2},{value:"Adding Books - CREATE",id:"adding-books---create",level:2},{value:"Getting All Books - READ",id:"getting-all-books---read",level:3},{value:"Retrieving a Book by ID",id:"retrieving-a-book-by-id",level:3},{value:"Editing Books - UPDATE",id:"editing-books---update",level:3},{value:"Deleting Books - DELETE",id:"deleting-books---delete",level:3},{value:"Code",id:"code",level:2}],d={toc:p};function u(e){let{components:t,...n}=e;return(0,a.kt)("wrapper",(0,o.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h2",{id:"what-is-crud"},"What is CRUD?"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Create,_read,_update_and_delete"},"CRUD")," is an acronym for Create, Read, Update and Delete. It is a set of operations we get servers to execute (POST, GET, PUT and DELETE respectively). This is what each operation does:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Create (POST) \u2014 Make something"),(0,a.kt)("li",{parentName:"ul"},"Read (GET) \u2014 Get something"),(0,a.kt)("li",{parentName:"ul"},"Update (PUT/PATCH) \u2014 Change something"),(0,a.kt)("li",{parentName:"ul"},"Delete (DELETE) \u2014Remove something")),(0,a.kt)("p",null,"Great. Let's take a look at how these operations work."),(0,a.kt)("h2",{id:"what-were-building"},"What we're building"),(0,a.kt)("p",null,"We're going to build a CRUD of Book that allows you to keep track of data related to the books. For the sake of simplicity, I won't be using a database, so you don't need experience using one. We will use a simple JavaScript array to store our data instead."),(0,a.kt)("h2",{id:"getting-started"},"Getting started"),(0,a.kt)("p",null,"Start by creating a folder for this project. Feel free to call it anything you want. Once you navigate into it, run the ",(0,a.kt)("inlineCode",{parentName:"p"},"npm init")," command."),(0,a.kt)("p",null,"This command creates a package.json file which helps you manage dependencies that we install later. Now do some changes to ",(0,a.kt)("inlineCode",{parentName:"p"},"package.json")," file and create ",(0,a.kt)("inlineCode",{parentName:"p"},"index.js")," file, as we did in ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/mrizwanashiq/learning-express-js/wiki/5.-Basic-Code"},"5. Basic Code")),(0,a.kt)("h2",{id:"adding-books---create"},"Adding Books - CREATE"),(0,a.kt)("p",null,"The CREATE operation is performed when you want to save data (into database), and to do this POST request is sent to the server. In Express, we handle a POST request with the post method:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"app.post(path, callback)\n")),(0,a.kt)("p",null,"The first argument, path, is the path of the GET request. It's anything that comes after your domain name."),(0,a.kt)("p",null,"When we're visiting localhost:3000, our browsers are actually looking for ",(0,a.kt)("inlineCode",{parentName:"p"},"localhost:3000/"),". The path argument, in this case, is ",(0,a.kt)("inlineCode",{parentName:"p"},"/"),"."),(0,a.kt)("p",null,"The second argument is a callback function that tells the server what to do when the path is matched. It takes in two arguments, a request object and a response object:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"app.post('/', function (request, response) {  \n    // do something here\n})\n")),(0,a.kt)("p",null,"So, let's write a post method to save data:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"// Importing package\nimport express from 'express';\nimport bodyParser from 'body-parser';\nimport cors from 'cors';\n\nconst app = express();\nconst port = 3000;\n\n// Where we will keep books\nlet books = [];\n\n// Configuring middlewares\napp.use(cors());\napp.use(bodyParser.urlencoded({ extended: false }));\napp.use(bodyParser.json());\n\n// POST API\napp.post('/book', (req, res) => {\n    // We will be coding here\n});\n\napp.listen(port, () => console.log(`Hello world app listening on port ${port}!`));\n")),(0,a.kt)("p",null,"As you can see, we can configure body-parser by importing it and passing it to the ",(0,a.kt)("inlineCode",{parentName:"p"},"app.use")," method, which enables it as middleware to the Express app instance."),(0,a.kt)("p",null,"We will be using the books array to store our collection of books, simulating a database."),(0,a.kt)("p",null,"There are a few types of HTTP request body types. For example, ",(0,a.kt)("inlineCode",{parentName:"p"},"application/x-www-form-urlencoded")," is the default body type for forms, whereas ",(0,a.kt)("inlineCode",{parentName:"p"},"application/json")," is something we'd use when requesting a resource using jQuery or the backend REST client."),(0,a.kt)("p",null,"What the ",(0,a.kt)("inlineCode",{parentName:"p"},"body-parser")," middleware will be doing is grabbing the HTTP body, decoding the information, and appending it to the ",(0,a.kt)("inlineCode",{parentName:"p"},"req.body"),". From there, we can easily retrieve the information from the form - in our case, a book's information."),(0,a.kt)("p",null,"We're sending this data inside request's body "),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "name": "The Lord of the Rings",\n    "author": "J.R.R. Tolkien",\n    "publisher": "Allen & Unwin",\n}\n')),(0,a.kt)("p",null,"Inside the ",(0,a.kt)("inlineCode",{parentName:"p"},"app.post")," method let's add the book to the book array:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"app.post('/book', (req, res) => {\n    const book = req.body;\n\n    // here length of books' array will be the id of that book\n    book.id = books.length + 1;\n\n    // Output the book to the console for debugging\n    console.log(book);\n    books.push(book);\n\n    res.send('Book is added to the database');\n});\n")),(0,a.kt)("h3",{id:"getting-all-books---read"},"Getting All Books - READ"),(0,a.kt)("p",null,"The READ operation is performed by browsers whenever you visit a webpage. Under the hood, browsers send a GET request to the server to perform a READ operation. The reason we see the \u201ccannot get /\u201d error is that we have yet to send anything back to the browser from our server."),(0,a.kt)("p",null,"In Express, we handle a GET request with the get method:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"app.get(path, callback)\n")),(0,a.kt)("p",null,"Now let's create an endpoint to get all the books from the API:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"app.get('/book', (req, res) => {\n    res.json(books);\n});\n")),(0,a.kt)("p",null,"Restart the server. If the server is already running press ",(0,a.kt)("inlineCode",{parentName:"p"},"Ctrl + C")," to stop it first. Add some books and open ",(0,a.kt)("inlineCode",{parentName:"p"},"http://localhost:3000/books")," in your browser. You should see a JSON response with all the books that you've added."),(0,a.kt)("p",null,"In this case, the JSON response will be like"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json"},'[\n    {\n        "id": 1,\n        "name": "The Lord of the Rings",\n        "author": "J.R.R. Tolkien",\n        "publisher": "Allen & Unwin",\n    }\n]\n')),(0,a.kt)("h3",{id:"retrieving-a-book-by-id"},"Retrieving a Book by ID"),(0,a.kt)("p",null,"If we'd like to display a specific book to the user, we'll need a way to retrieve it from the database (or the array, in our case). This is always done by a key specific to that entity. In most cases, each entity has a unique id that helps us identify them."),(0,a.kt)("p",null,"In our case, each book has an id that is unique by nature, so there's no need for another id value."),(0,a.kt)("p",null,"This is typically done by parsing the URL parameter for an id and searching for the book with the corresponding id."),(0,a.kt)("p",null,"For example, if the id is 1 the URL would look like, ",(0,a.kt)("inlineCode",{parentName:"p"},"http://localhost:3000/book/1"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"app.get('/book/:id', (req, res) => {\n    // Reading ID from the URL\n    const id = parseInt(req.params.id);\n\n    // Searching books for the id\n    for (let book of books) {\n        if (book.id === id) {\n            res.json(book);\n            return;\n        }\n    }\n\n    // Sending 404 when not found something is a good practice\n    res.status(404).send('Book not found');\n});\n")),(0,a.kt)("h3",{id:"editing-books---update"},"Editing Books - UPDATE"),(0,a.kt)("p",null,"Very similar to deleting entities, updating them requires us to snatch a specific one, based on the id and then send either a ",(0,a.kt)("inlineCode",{parentName:"p"},"PATCH")," or ",(0,a.kt)("inlineCode",{parentName:"p"},"PUT")," HTTP call with the new information."),(0,a.kt)("p",null,"First I'll do ",(0,a.kt)("inlineCode",{parentName:"p"},"PUT"),", where I'll replace the book's data with the new one"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"app.put('/book/:id', (req, res) => {\n    // Reading id from the URL\n    const id = parseInt(req.params.id);\n    const book = req.body;\n    book.id = id\n\n    // Remove item from the books array\n    for (let i = 0; i < books.length; i++) {\n        if (book[i].id === id) {\n            books[i] = book;\n        }\n    }\n\n    res.send('Book is replace');\n});\n")),(0,a.kt)("p",null,"Now ",(0,a.kt)("inlineCode",{parentName:"p"},"PATCH"),", here I'll update the book's data"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"app.patch('/book/:id', (req, res) => {\n    // Reading id from the URL\n    const id = parseInt(req.params.id);\n    const book = req.body;\n    book.id = id\n\n    // Remove item from the books array\n    for (let i = 0; i < books.length; i++) {\n        if (book[i].id === id) {\n            books[i] = {...book[i], ...book};\n        }\n    }\n\n    res.send('Book is update');\n});\n")),(0,a.kt)("h3",{id:"deleting-books---delete"},"Deleting Books - DELETE"),(0,a.kt)("p",null,"When deleting entities, we typically delete them one by one to avoid big accidental data loss. To delete items, we use the HTTP ",(0,a.kt)("inlineCode",{parentName:"p"},"DELETE")," method and specify a book using its id, just like how we retrieved it:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"app.delete('/book/:id', (req, res) => {\n    // Reading id from the URL\n    const id = parseInt(req.params.id);\n\n    // Remove item from the books array\n    books = books.filter(i => {\n        if (i.id !== id) {\n            return true;\n        }\n        return false;\n    });\n\n    res.send('Book is deleted');\n});\n")),(0,a.kt)("p",null," We are using the ",(0,a.kt)("inlineCode",{parentName:"p"},"app.delete")," method to accept ",(0,a.kt)("inlineCode",{parentName:"p"},"DELETE")," requests. We have also used the array ",(0,a.kt)("inlineCode",{parentName:"p"},"filter")," method to filter out the book with the relevant id to remove it from the array."),(0,a.kt)("p",null,"That's how easy it is to build a CRUD using Node.js and Express. "),(0,a.kt)("h2",{id:"code"},"Code"),(0,a.kt)("p",null,"You can download the related code from ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/mrizwanashiq/learning-express-js/tree/example/crud-code"},"here")))}u.isMDXComponent=!0}}]);